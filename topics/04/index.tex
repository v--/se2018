\documentclass[numbers=endperiod, bibliography=totocnumbered]{scrartcl}

\usepackage{../../common/common_packages}
\usepackage{../../common/macros}
\usepackage{../../common/theorem_styles}

% Misc packages
\usepackage{tikz}
\usepackage{float} % Allowing figures inside minipages

% Bibliography
\addbibresource{./references.bib}

% Document
\title{Тема 4 от \URL{https://github.com/v--/se2018}}
\subtitle{Граница, непрекъснатост, производна и примитивна на функция на една променлива. Геометрична интерпретация.}
\author{Янис Василев}
\date{Оригинал: 6 юли 2019 \\ Ревизия: \input{../../revision} \\ За всеки случай проверете дали няма по-нова ревизия}

\begin{document}

\maketitle

\section{Теория}

Теорията е разписана без външни източници.

\subsection{Анотация}

Изложената анотацията е взета от конспекта~\cite{Syllabus} за 2018г.

\begin{enumerate}
  \item Дефиниции на Хайне и Коши за граница на функция в крайна точна и в безкрайността
  \item Еквивалентност на дефинициите на Хайне и Коши за
  \item Дефиниция за непрекъснатост на функция чрез дефинициите на Хайне и Коши
  \item Дефиниция за производна на функция като граница на диференчните частно
  \item Физична интерпретация на производната като моментна скорост
  \item Геометрична интерпретация на производната в точка като ъглов коефициент на допирателната към графиката на функцията
  \item Формули за сума, произведение, частно и съставна функция на две диференцируеми функции
  \item Производни на степенна, показателна и основните тригонометрични функции
  \item Формула за производна на обратна функция
  \item Използване на формулата за производна на обратна функция за намиране на производните на \( \ln x \) и \( \arcsin x \).
  \item Дефиниция за примитивна функция
  \item Разликата на две примитивни функции над интервал е константа
\end{enumerate}

\subsection{Отворени множества}

\begin{definition}
  Множеството \( U \subseteq \R \) ще наричаме \textbf{отворено}, ако \( U \) е обединение на (произволен брой) отворени интервали. В частност, \( \varnothing \) е отворено като обединение на \( 0 \) множества. Това определение изглежда нагласено, но всъщност казва, че отворените интервали са база за стандартната топология в \( \R \).

  Ако \( U \) е отворено множество и \( x \in U \), казваме, че \( U \) е \textbf{околност} на \( x \).
\end{definition}

За удобство, при изследване на сходимост понякога се ограничаваме до отворени интервали вместо произволни отворени множества. В.ж., например, твърдение~\ref{thm:sequence_converges_in_topology_iff_converges_in_base}.

\begin{lemma}\label{thm:real_numbers_are_hausdorff}
  Ако \( a < b \) са реални числа, те имат поне една двойка непресичащи се околности.
\end{lemma}
\begin{proof}
  Разглеждаме, например, интервалите \( U_a = \left(a, \tfrac {a + b} 2 \right) \) и \( U_b = \left(\tfrac {a + b} 2, b\right) \).
\end{proof}

\subsection{Граница на редица}

\begin{definition}
  Безкрайните последователности от реални числа наричаме редици и бележим с \( {\{ a_k \}}_{k=1}^\infty \) или просто с \( \{ a_k \} \), когато няма опасност от недоразумение.

  Формално, редиците са функции \( \mathbb{N} \to \R \).
\end{definition}

\begin{definition}
  Нека \( D \subseteq \R \) е произволно непразно множество. Казваме, че \( a \in D \) е \textbf{точка на сгъстяване} на множеството \( D \) или \textbf{гранична точка} на \( D \), ако във всяка околност на \( a \) има точки на \( D \), различни от \( a \).
\end{definition}

\begin{definition}
  Нека \( D \subseteq \R \) и \( \{ a_k \} \subseteq D \) е произволна редица. Казваме, че \( a \) е \textbf{граница на редицата} \( \{ a_k \} \) или че редицата \( \{ a_k \} \) \textbf{клони} към \( a \), ако всяка околност на \( a \) съдържа цялата редица с изключение на краен брой членове. Пишем
  \begin{align*}
    \lim_{k \to \infty} a_k = a,
    &&
    a_k \Conv[k \to \infty]{} a.
  \end{align*}

  Ако една редица има граница, казваме, че \textbf{редицата е сходяща}. Ако една редица не е сходяща, тя е \textbf{разходяща}.
\end{definition}

\begin{remark}
  В общия случай е възможно \( a \not\in D \).
\end{remark}

\begin{proposition}
  Сходящите редици \( \{ a_k \} \subseteq D \) имат единствена граница.
\end{proposition}
\begin{proof}
  Нека \( a \) и \( b \) са граници на редицата \( \{ a_k \} \). Ако \( a \) и \( b \) са различни, те непременно имат поне една двойка непресичащи се околности според лема \ref{thm:real_numbers_are_hausdorff}.

  От друга страна, ако \( U_a \) и \( U_b \) са някакви околности на \( a \) и \( b \), те непременно се пресичат, тъй като и двете съдържат цялата редица с изключение на краен брой членове. Заключаваме, че \( a = b \).
\end{proof}

\begin{proposition}\label{thm:sequence_converges_in_topology_iff_converges_in_base}
  Редица \( \{ a_k \} \subseteq D \) от реални числа клони към \( a \) тогава и само тогава за всяко положително число \( \varepsilon > 0 \) съществува индекс \( k_0 \) такъв, че при \( k \geq k_0 \) да бъде изпълнено \( \Abs{a_k - a} < \varepsilon \).
\end{proposition}
\begin{proof}
  Първо ще докажем достатъчност. Фиксираме \( \varepsilon \) и предполагаме, че само краен брой членове на редицата не се съдържат в интервала \( (a - \tfrac{\varepsilon} 2, a + \tfrac{\varepsilon} 2) \). Тогава съществува индекс \( k_0 \), такъв че всички членове на редицата след \( a_{k_0} \) се съдържат в интервала, т.е. \( \Abs{a - a_k} < \varepsilon \) за всяко \( k \geq k_0 \).

  Обратно, ако е зададена околност \( U \) на \( a \), избираме отворен интервал \( (a - \tfrac \varepsilon 2, a + \tfrac \varepsilon 2) \subseteq U \) и индекс \( k_0 \), така че \( \Abs{a - a_k} < \varepsilon \) при \( k \geq k_0 \). Получаваме, че единствено краен брой членове на редицата с индекси, по-малки от \( k_0 \), потенциално се съдържат извън \( (a - \tfrac \varepsilon 2, a + \tfrac \varepsilon 2) \).
\end{proof}

\begin{proposition}\label{thm:limits_of_elementwise_sums_and_products}
  Ако редиците \( \{ a_k \} \subseteq D \) и \( \{ b_k \} \subseteq D \) клонят към \( a \) и \( b \), съответно, тогава
  \begin{enumerate}
    \item \( a_k + b_k \xrightarrow[k \to \infty]{} a + b \)
    \item \( a_k b_k \xrightarrow[k \to \infty]{} a b \)
  \end{enumerate}
\end{proposition}
\begin{proof}
  Понеже \( a_k \to a \) и \( b_k \to b \), можем да изберем индекс \( k \) и \( \delta > 0 \) такива, че да бъдат изпълнени неравенствата \( \Abs{a - a_k} < \delta \) и \( \Abs{b - b_k} < \delta \).

  \begin{enumerate}
    \item От неравенството на триъгълника следва
    \begin{equation*}
      \Abs{(a + b) - (a_k + b_k)}
      =
      \Abs{(a - a_k) + (b - b_k)}
      \leq
      \Abs{a - a_k} + \Abs{b - b_k}
      <
      2\delta.
    \end{equation*}

    И така, при зададено \( \varepsilon > 0 \), достатъчно е да положим \( \delta \coloneqq \tfrac \varepsilon 2 \), за да съществува индекс \( k_0 \), за който
    \begin{equation*}
      \Abs{(a + b) - (a_k + b_k)} < \varepsilon \quad\forall k \geq k_0.
    \end{equation*}

    \item Развиваме израза
    \begin{align*}
      ab - a_k b_k
      &=
      (ab - a b_k) + (a b_k - a_k b) + (a_k b - a_k b_k)
      = \\ &=
      a (b - b_k) + (a b_k - ab + ab - a_k b) + (-a_k)(b_k - b)
      = \\ &=
      a (b - b_k) + a \underbrace{(b_k - b)} + (a - a_k) b + (-a_k)\underbrace{(b_k - b)}
      = \\ &=
      a \underbrace{(b - b_k)}_{\in (-\delta, \delta)} + \underbrace{(a - a_k)}_{\in (-\delta, \delta)} \underbrace{(b_k - b)}_{\in (-\delta, \delta)} + \underbrace{(a - a_k)}_{\in (-\delta, \delta)} b.
    \end{align*}

    Следователно \( \Abs{ab - a_k b_k} < \delta^2 + \Abs{a + b} \delta \). Ако поискаме \( \delta \) да бъде по-малко от \( 1 \), ще получим \( \delta^2 \leq \delta \) и, съответно, \( \Abs{ab - a_k b_k} < (1 + \Abs{a + b}) \delta \).

    И така, при зададено \( \varepsilon > 0 \), достатъчно е да положим \( \delta = \tfrac {\min \{\varepsilon, 1 \}} {1 + \Abs{a + b}} \), за да съществува индекс \( k_0 \), за който
    \begin{equation*}
      \Abs{ab - a_k b_k} < \varepsilon \quad\forall k \geq k_0.
    \end{equation*}
  \end{enumerate}
\end{proof}

\begin{definition}
  Нека редицата \( \{ a_k \} \) е неограничена, т.е. всяка околност на \( 0 \) съдържа само краен брой нейни елементи. Казваме, че редицата \textbf{клони към безкрайност} и пишем
  \begin{equation*}
    \lim_{k \to \infty} a_k = \infty,
  \end{equation*}
  ако редицата е (нестрого) монотонно растяща с изключение на краен брой членове.

  Аналогично се дефинира сходимост към отрицателна безкрайност \( -\infty \) за неограничени монотонно намаляващи редици.
\end{definition}

\subsection{Граница на функция}

\begin{remark}
  За съжаление, когато допуснем сходимост във и към безкрайни точки, можем да получим комбинаторна експлозия от определения. Затова в началото ще дадем различни дефиниции само за сходимост във и към крайни точки и ще докажем еквивалентността им, а след това ще дадем само едно определение за останалите видове сходимост.

  Алтернативен подход е да се използва компактификация, т.е. добавяне на точките \( \infty \) и \( -\infty \) като класове на еквивалентност редици, клонящи към безкрайност. Този подход, обаче, конфликтира с алгебричните свойства на реалните числа и е прекалено нестандартен, за да се използва на изпит.
\end{remark}

\begin{definition}[Сходимост по Хайне]
  Нека \( a \) е точка на сгъстяване на \( D \subseteq \R \). Казваме, че функцията \( f: D \to \R \) \textbf{клони} към \( A \) при \( x \) клонящо към \( a \) или \( A \) е граница на \( f(x) \) при \( x \) клонящо към \( a \) и пишем
  \begin{align*}
    \lim_{x \to a} f(x) = A,
    &&
    f(x) \Conv[x \to a]{} A,
  \end{align*}
  ако за всяка сходяща към \( a \) редица \( \{ a_k \} \subseteq D \) съответната редица от функционални стойности \( {\{ f(a_k) \}}_{k=1}^\infty \) клони към \( A \).
\end{definition}

\begin{definition}[Сходимост по Коши]
  Нека \( a \) е точка на сгъстяване на \( D \subseteq \R \). Казваме, че функцията \( f: D \to \R \) \textbf{клони} към \( A \) при \( x \) клонящо към \( a \), ако за всяко положително число \( \varepsilon > 0 \) съществува \( \delta > 0 \), така че за всяко \( x \in \R \) при \( \Abs{x - a} < \delta \) да е изпълнено \( \Abs{f(x) - A} < \varepsilon \).
\end{definition}

\begin{remark}
  В общия случай, функцията може не просто да не съвпада с границата си в дадена точка, а може и да не бъде дефиниране в тази точка.
\end{remark}

\begin{theorem}\label{thm:heine_iff_cauchy}
  Определенията на Хайне и Коши за сходимост са еквивалентни.
\end{theorem}
\begin{proof}
  (Хайне \( \implies \) Коши). Нека \( f: D \to \R \) клони към \( A \) в точката \( a \) според определението на Хайне и нека \( \varepsilon > 0 \) е произволно.

  С цел да получим противоречие, допускаме, че условието на Коши за сходимост не е изпълнено, т.е. за всяко \( \delta > 0 \) съществува \( a_\delta \in (a - \delta, a + \delta) \), такова че \( f(a_\delta) \) е извън интервала \( (A - \varepsilon, A + \varepsilon) \).

  Построяваме редица \( \{ a_n \}_{n=1}^\infty \), където \( a_n \) избираме така, че \( a_n \in \left(a - \frac 1 n, a + \frac 1 n \right) \) и \( f(a_n) \not\in (A - \varepsilon, A + \varepsilon) \). Построената редица очевидно клони към \( a \) и според определението на Хайне за сходимост на функция, само краен брой членове от редицата \( \{ f(a_n) \}_{n=1}^\infty \) са извън интервала \( (A - \varepsilon, A + \varepsilon) \). Но това противоречи на избора на елементи на редицата \( \{ a_n \}_{n=1}^\infty \).

  Следователно е изпълнено определението на Коши за сходимост.

  (Коши \( \implies \) Хайне). Нека \( f: D \to \R \) клони към \( A \) в точката \( a \) според определението на Коши.

  Нека \( U \) е произволна околност на \( A \) и нека числото \( \varepsilon > 0 \) е такова, че интервалът \( (A - \varepsilon, A + \varepsilon) \), който също е околност на \( A \), се съдържа в \( U \). От определението на Коши за сходимост съществува число \( \delta > 0 \), за което за произволно \( x \in \R \) неравенството \( 0 < \Abs{x - a} < \delta \) да влече \( \Abs{f(x) - A} < \varepsilon \).

  Нека редицата \( \{ a_k \} \) клони към \( a \) и нека \( n \) е най-големият индекс, за който \( \Abs{a - a_n} \geq \delta \), или \( n = 0 \), ако няма такива членове. Тогава подредицата \( {\{ a_k \}}_{k>n} \) също клони към \( a \), а редицата \( {\{ f(a_k) \}}_{k>n} \) се съдържа изцяло в околността \( (A - \varepsilon, A + \varepsilon) \subseteq U \) на \( a \).

  Но това означава, че редицата \( {\{ f(a_k) \}}_{k>0} \) клони към \( A \) и следователно е изпълнено определението на Хайне за сходимост.
\end{proof}

\begin{proposition}\label{thm:limit_is_linear_and_multiplicative}
  Нека \( a \) е точка на сгъстяване на \( D \subseteq \R \). Ако \( f: D \to \R \) клони към \( A \) в точката \( a \) и \( g: D \to \R \) клони към \( B \) в точката \( a \), тогава
  \begin{enumerate}
    \item За произволна константа \( c \in \R \)
    \begin{equation*}
      \lim_{x \to a} [c f(x)] = c A.
    \end{equation*}

    \item Граничният преход е адитивен
    \begin{equation*}
      \lim_{x \to a} [f(x) + g(x)] = A + B.
    \end{equation*}

    \item Граничният преход е мултипликативен
    \begin{equation*}
      \lim_{x \to a} [f(x) \cdot g(x)] = A \cdot B.
    \end{equation*}
  \end{enumerate}
\end{proposition}
\begin{proof}
  Следва директно от твърдения~\ref{thm:heine_iff_cauchy} и~\ref{thm:limits_of_elementwise_sums_and_products}.
\end{proof}

\begin{definition}[Обобщена сходимост по Хайне]
  Нека редицата \( \{ a_k \} \subseteq D \) клони към крайна или безкрайна граница \( a \), т.е. \( a \) е точка на сгъстяване на \( D \) или \( a = \pm \infty \), а редицата от функционални стойности \( \{ f(a_k) \} \) клони към крайна или безкрайна граница \( A \), т.е. \( A \in \R \) или \( A = \pm \infty \). Казваме, че функцията \( f(x) \) \textbf{клони} към \( A \) при \( x \) клонящо към \( a \) и пишем
  \begin{equation*}
    \lim_{x \to a} f(x) = A.
  \end{equation*}
\end{definition}

\subsection{Непрекъснатост}

\begin{definition}[Непрекъснатост по Хайне]
  Нека \( D \subseteq \R \) и \( a \in D \) е точка на сгъстяване на \( D \). Казваме, че функцията \( f: D \to \R \) е \textbf{непрекъсната} в точката \( a \), ако за произволна редица \( \{ a_k \} \subseteq D \), клоняща към \( a \), съответната редица \( \{ f(a_k) \} \) от функционални стойности клони към \( f(a) \).
\end{definition}

\begin{definition}[Непрекъснатост по Коши]
  Нека \( D \subseteq \R \) и \( a \in D \) е точка на сгъстяване на \( D \). Казваме, че функцията \( f: D \to \R \) е \textbf{непрекъсната} в точката \( a \), ако за всяко положително число \( \varepsilon > 0 \) съществува \( \delta > 0 \), така че за всяко \( x \in \R \) при \( 0 < \Abs{x - a} < \delta \) да е изпълнено \( \Abs{f(x) - f(a)} < \varepsilon \).
\end{definition}

\begin{remark}
  От теорема~\ref{thm:heine_iff_cauchy} следва, че двете определения за непрекъснатост съвпадат и са еквивалентни на следната проста формула:
  \begin{equation*}
    \lim_{x \to a} f(x) = f\left( \lim_{x \to a} x \right).
  \end{equation*}
\end{remark}

\begin{definition}
  Казваме, че една \( f(x) \) е \textbf{непрекъсната навсякъде} или \textbf{поточково непрекъсната}, ако \( f(x) \) е непрекъсната във всяка точка от дефиниционната си област.
\end{definition}

\subsection{Диференцируемост}

\begin{definition}
  Нека точката \( a \) принадлежи на \( D \) заедно със своя дясна околност, т.е. за някое число \( \varepsilon > 0 \) интервалът \( [a, a + \varepsilon) \) лежи изцяло в \( D \). \textbf{Производна} на функцията \( f: D \to \R \) в точка \( a \in D \) наричаме границата
  \begin{equation*}
    \lim_{\substack{h \to 0 \\ h \neq 0}} \frac {f(a + h) - f(a)} h.
  \end{equation*}

  Частното \( \frac {f(a + h) - f(a)} h \) наричаме \textbf{диференчно частно}. За простота, ще изпускаме условието \( h \neq 0 \) от записа, но ще предполагаме, че е изпълнено.

  Ако \( f(x) \) има производна в точка \( a \), казваме, че тя е \textbf{диференцируема} в тази точка.

  Ако \( D \subseteq \R \) е отворено множество и функцията \( f: D \to \R \) е диференцируема в цялата си дефиниционна област, казваме, че тя е диференцируема, без да правим допълнително пояснения. В такъв случай производните се разглеждат като функция на \( x \in D \). Ако производната \( f'(x) \) съществува в околност на \( a \) и е непрекъсната в \( a \), казваме, че \( f(x) \) е непрекъснато диференцируема.

  Ако функцията \( f(x) \) е диференцируема в \( a \), \textbf{диференциал} \( df(a) \) на \( f(x) \) в точката \( a \) наричаме линейната функция \( h \mapsto f'(a) \cdot h \).

  Диференциалът на променливата \( x \), разгледана като идентитет, е също идентитет, тъй като диференчното частно \( \frac {(x + h) - x} h \) на идентитета е константата \( 1 \). Понеже диференциалът \( dx(a) \) не зависи от точката \( a \), ще пишем просто \( dx \).

  Това ни дава основание да въведем \textbf{означенията на Лайбниц} за производни като частно на диференциалите
  \begin{equation*}
    \frac {df(a)} {dx} = \frac {f'(a) \cdot h} h = f'(a).
  \end{equation*}
\end{definition}

\begin{remark}
  Ако множеството \( D \) не е отворено, за функцията \( f(x) \) с дефиниционна област \( D \) не възможно да се определят леви или десни производни в някои точки. Затова обикновено, когато говорим за диференцируемост, искаме функцията да бъде дефинирана в отворено множество.
\end{remark}

\begin{proposition}
  Нека \( D \subseteq \R \) е отворено и функцията \( f: D \to \R \) е диференцируема в точка \( a \in D \). Тогава \( f(x) \) е и непрекъсната в \( a \).
\end{proposition}
\begin{proof}
  Производната \( f'(a) \) е крайно число, следователно от твърдение~\ref{thm:limits_of_elementwise_sums_and_products} получаваме
  \begin{equation*}
    \lim_{h \to 0} [f(a+h) - f(a)]
    =
    \lim_{h \to 0} \frac {f(a+h) - f(a)} h \cdot \lim_{h \to 0} h
    =
    f'(a) \cdot 0
    =
    0.
  \end{equation*}
\end{proof}

\begin{theorem}[Механична интерпретация на производна]
  Ако пътят, изминат от материална частица за време \( t \), се описва чрез диференцируемата функция \( f(t) \), тогава моментната скорост във времето \( t \) е равна на \( f'(t) \).
\end{theorem}
\begin{proof}
  Нека \( T > 0 \) и нека функцията \( f: [0, T] \to \R \) е диференцируема в точка \( t \in (0, T) \).

  Изразявайки приблизително нарастването на пътя \( f(t+h) - f(t) \approx h v(t) \) като нарастването на времето умножено по скоростта \( v(t) \) на движение в момента \( t \), получаваме
  \begin{equation*}
    v(t) = \frac{f(t+h) - f(t)} {h} \Conv[h \to 0]{} f'(t).
  \end{equation*}
\end{proof}

\bigskip
\begin{minipage}{0.45\textwidth}
  \begin{theorem}[Геометрична интерпретация на производна]
    Нека \( D \subseteq \R \) и функцията \( f: D \to \R \) е диференцируема в точка \( a \in D \). Разглеждаме графиката \( \Gamma_f = \{ (x, f(x)) \mid x \in D \} \) на \( f(x) \) като параметрична крива в равнината.

    За някое достатъчно малко по абсолютна стойност число \( h \in \R \) разглеждаме секущата \( d_h \) през точките с координати \( (a, f(a)) \) и \( (a+h, f(a+h)) \) (фиг.~\ref{fig:secant}). При намаляващо \( h \), декартовите уравнения на тези секущи при се приближават към декартово уравнение на допирателна права \( d \) към \( \Gamma_f \) в точката \( a \).

    Твърдим, че декартовото уравнение на тази допирателна права е
    \begin{equation*}
      d: y = f'(a) (x-a) + f(a).
    \end{equation*}
  \end{theorem}
\end{minipage}
\hspace{0.5cm}
\begin{minipage}{0.45\textwidth}
  \begin{figure}[H]\label{fig:secant}
    \centering
    \begin{tikzpicture}
      \draw[->] (-1,0) -- (4,0) node[below right] {\( x \)};
      \draw[->] (0,-1) -- (0,4) node[left] {\( y \)};
      \draw [domain=-1:2.7, samples=40] plot (\x, \x^2/2);
      \filldraw [black] (2, 2) circle (1.5pt);
      \filldraw [black] (1/2, 1/8) circle (1.5pt);
      \draw[-] (0, -1/2) -- (16/5, 3.5);
    \end{tikzpicture}
    \caption{Секуща през две точки от графиката}
  \end{figure}
\end{minipage}
\begin{proof}
  Тъй като точките \( (a, f(a)) \) и \( (a+h, f(a+h)) \) лежат върху правата \( d_h \), получаваме общото уравнение за \( d_h \)
    \begin{align*}
      d_h: \det \begin{pmatrix}
      (a+h)-x & (a+h)-a \\
      f(a+h)-y & f(a+h)-f(a)
    \end{pmatrix}
    = 0.
  \end{align*}

  Оттук намираме декартовото уравнение на \( d_h \):
  \begin{align*}
    d_h&: (f(a+h) - f(a)) (a+h-x) - (f(a+h)-y)h \mid \cdot \frac 1 h = 0,
    \\
    d_h&: \frac {f(a+h) - f(a)} h (a-x) + (f(a+h) - f(a)) - f(a+h) + y = 0,
    \\
    d_h&: y = -\frac {f(a+h) - f(a)} h (a-x) + f(a),
    \\
    d_h&: y = \frac {f(a+h) - f(a)} h (x-a) + f(a).
  \end{align*}

  С граничен предох при \( h \to 0 \) получаваме уравнението от твърдението на теоремата.
\end{proof}

\begin{theorem}
  Ако функциите \( f(x) \) и \( g(x) \) са едновременно диференцируеми в точка \( a \), имаме
  \begin{enumerate}
    \item \( (f+g)'(a) = f'(a) + g'(a) \)
    \item \( (f \cdot g)'(a) = f'(a) g(a) + f'(a) g(a) \)
    \item \( (\frac f g)'(a) = \frac{f'(a) g(a) - f(a) g'(a)} {{g(a)}^2} \)
  \end{enumerate}
\end{theorem}
\begin{proof}
  \mbox{}
  \begin{enumerate}
    \item От адитивността на граничния преход (твърдение~\ref{thm:limit_is_linear_and_multiplicative}) директно следва
    \begin{align*}
      (f+g)'(a)
      &=
      \lim_{h \to 0} \frac {(f+g)(a+h) - (f+g)(a)} h
      = \\ &=
      \lim_{h \to 0} \frac {f(a+h)-f(a)} h + \lim_{h \to 0} \frac{g(a+h) - g(a)} h
      = \\ &=
      f'(a) + g'(a).
    \end{align*}

    \item Използваме мултипликативността на граничния преход от твърдение~\ref{thm:limit_is_linear_and_multiplicative}, за да получим
    \begin{align*}
      &(f \cdot g)'(a)
      = \\ &=
      \lim_{h \to 0} \frac {(f \cdot g)(a+h) - (f \cdot g)(a)} h
      = \\ &=
      \lim_{h \to 0} \frac {f(a+h) g(a+h) - f(a+h) g(a) + f(a+h) g(a) - f(a) g(a)} h
      = \\ &=
      \lim_{h \to 0} \frac {f(a+h) g(a+h) - f(a+h) g(a)} h + \lim_{h \to 0} \frac {f(a+h) g(a) - f(a) g(a)} h
      = \\ &=
      \lim_{h \to 0} f(a+h) \cdot \lim_{h \to 0} \frac {g(a+h) + g(a)} h + \lim_{h \to 0} \frac {f(a+h) - f(a)} h \cdot g(a)
      = \\ &=
      f(a) g'(a) - f'(a) g(a).
    \end{align*}

    \item Отново използваме свойствата от твърдение~\ref{thm:limit_is_linear_and_multiplicative}, за да получим
    \begin{align*}
      &\left( \frac f g \right)'(a)
      = \\ &=
      \lim_{h \to 0} \frac {\left(\frac f g \right)(a+h) - \left(\frac f g \right)(a)} h
      = \\ &=
      \lim_{h \to 0} \frac {f(a+h) g(a) - f(a) g(a+h)} {h \cdot g(a) \cdot g(a+h)}
      = \\ &=
      \lim_{h \to 0} \frac 1 {g(a) \cdot g(a+h)} \cdot \lim_{h \to 0} \frac {f(a+h) g(a) - f(a) g(a+h)} h
      = \\ &=
      \frac 1 {{g(a)}^2} \left( \lim_{h \to 0} \frac {f(a+h) g(a) - f(a) g(a)} h - \lim_{h \to 0} \frac {f(a) g(a+h) - f(a) g(a)} h \right)
      = \\ &=
      \frac 1 {{g(a)}^2} \left( g(a) \lim_{h \to 0} \frac {f(a+h) - f(a)} h - f(a) \lim_{h \to 0} \frac {g(a+h) - g(a)} h \right)
      = \\ &=
      \frac {f'(a) g(a) - f(a) g'(a)} {{g(a)}^2}.
    \end{align*}
  \end{enumerate}
\end{proof}

\begin{theorem}\label{thm:chain_rule}
  Ако функцията \( g(x) \) е диференцируема в точка \( a \) и \( f(x) \) е диференцируема в точка \( g(a) \), имаме
  \begin{equation*}
    (f \circ g)'(a) = (f' \circ g)(a) \cdot g'(a).
  \end{equation*}
\end{theorem}
\begin{proof}
  Ще разгледаме два случая.

  \begin{enumerate}
    \item Ако \( g'(a) = 0 \), поради непрекъснатостта на \( f(x) \) в точка \( g(a) \) имаме
    \begin{equation*}
      \lim_{h \to 0} \frac {f(g(a+h)) - f(g(a))} h
      =
      0
      =
      f'(g(a)) \cdot 0
      =
      f'(g(a)) \cdot g'(a).
    \end{equation*}

    \item Ако \( g'(a) \neq 0 \), можем да считаме, че \( g(a+h) - g(a) \neq 0 \) за достатъчно малки по абсолютна стойност \( h \in \R \). Тогава
    \begin{align*}
      \lim_{h \to 0} \frac {f(g(a+h)) - f(g(a))} h
      &=
      \lim_{h \to 0} \frac {f(g(a+h)) - f(g(a))} {g(a+h) - g(a)} \cdot \frac {g(a+h) - g(a)} h
      = \\ &=
      \lim_{h \to 0} \frac {f(g(a) + \Delta_h) - f(g(a))} {\Delta_h} \cdot \frac {g(a+h) - g(a)} h
      = \\ &=
      f'(g(a)) \cdot g'(a),
    \end{align*}
    където \( \Delta_h \coloneqq g(a+h) - g(a) \Conv[h \to 0]{} 0 \), тъй като \( g(x) \) е непрекъсната в \( a \).
  \end{enumerate}
\end{proof}

\begin{remark}
  Сега ще докажем добре познатите формули за производни за \( e^x \), \( \sin(x) \) и \( \cos(x) \). Доказателство силно зависи от начина, по който сме определили съответните функции. Например, ако ги определим чрез степенни редове, тъждествата ще последват директно от свойствата на степенните редове.

  Не знам какъв е правилният подход за ДИ, затова съм направил предположението, че \( \sin(x) \) и \( \cos(x) \) удовлетворяват известните от училище тригонометрични тъждества, независимо от това как са определени самите функции.

  За експоненциалната функция \( e^x \) ще използвам определението (\ref{eq:bernoulli_exponential_definition}).
\end{remark}

\begin{theorem}
  \mbox{}
  \begin{enumerate}
    \item Константните функции \( f(x) = c, c \in \R \) са диференцируеми навсякъде в \( \R \) и имат производни \( 0 \).
    \item Степенните функции \( f(x) = x^n, n = 1, 2, \ldots \) са диференцируеми навсякъде в \( \R \) и имат производни \( f'(x) = n x^{n-1} \).
    \item Показателните функции \( f(x) = \alpha^x, \alpha > 0 \) са диференцируеми навсякъде в \( \R \) и имат производни \( f'(x) = \ln \alpha \cdot \alpha^x \).
    \item Функциите \( \sin(x) \) и \( \cos(x) \) са диференцируеми навсякъде в \( \R \) и имат производни \( \sin'(x) = \cos(x) \) и \( \cos'(x) = -\sin(x) \).
  \end{enumerate}
\end{theorem}
\begin{proof}
  \mbox{}
  \begin{enumerate}
    \item За \( f(x) = c, c \in \R \) пресмятаме
    \begin{equation*}
      f'(x) = \lim_{h \to 0} \frac {c - c} h = 0.
    \end{equation*}

    \item За \( f(x) = x^n, n = 1, 2, \ldots \) използваме биномната теорема, за да пресметнем
    \begin{align*}
      f'(x)
      &=
      \lim_{h \to 0} \frac {{(x+h)}^n - x^n} h
      = \\ &=
      \lim_{h \to 0} \frac 1 h \left(\sum_{k=0}^n \binom{n}{k} x^k h^{n-k} - x^n \right)
      = \\ &=
      \lim_{h \to 0} \frac 1 h \left(\sum_{k=0}^{n-2} \binom{n}{k} x^k h^{n-k} + n \cdot x^{n-1} \cdot h^1 + 1 \cdot x^n \cdot h^0 - x^n \right)
      = \\ &=
      \lim_{h \to 0} \sum_{k=0}^{n-2} \binom{n}{k} x^k h^{n-k-1} + n x^{n-1}
      = \\ &=
      n x^{n-1}.
    \end{align*}

    \item За \( f(x) = \alpha^x, \alpha > 0 \) пресмятаме
    \begin{equation*}
      f'(x)
      =
      \lim_{h \to 0} \frac {\alpha^{x+h} - \alpha^x} h
      =
      \alpha^x \lim_{h \to 0} \frac {\alpha^h - 1} h
      =
      f'(0) \alpha^x.
    \end{equation*}

    Остава само да намерим производната на \( f(x) = \alpha^x \) в нулата. За целта временно се ограничаваме до \( \alpha = e \) и използваме определението
    \begin{equation}\label{eq:bernoulli_exponential_definition}
      e^x \coloneqq \lim_{n \to \infty} {\left( 1 + \frac x n \right)}^n.
    \end{equation}

    Така получаваме
    \begin{align*}
      f'(0)
      &=
      \lim_{h \to 0} \frac {e^h - 1} h
      = \\ &=
      \lim_{h \to 0} \frac 1 h \left( \lim_{n \to \infty} {\left( 1 + \frac h n \right)}^n - 1 \right)
      = \\ &=
      \lim_{h \to 0} \frac 1 h \left( \lim_{n \to \infty} \sum_{k=2}^n \binom{n}{k} {\left(\frac h n \right)}^k - 1 \right)
      = \\ &=
      \lim_{h \to 0} \frac 1 h \lim_{n \to \infty} \left( 1 + h + \sum_{k=2}^n \binom{n}{k} {\left(\frac h n \right)}^k - 1 \right)
      = \\ &=
      1 + \lim_{h \to 0} \lim_{n \to \infty} \sum_{k=2}^n \binom{n}{k} \frac {h^{k-1}} {n^k} = 1.
    \end{align*}

    Следователно производната на \( e^x \) е \( e^x \) и по теорема~\ref{thm:chain_rule} за \( f(x) = \alpha^x = e^{\ln \alpha \cdot x} \) имаме
    \begin{equation*}
      f'(x)
      =
      e^{\ln \alpha \cdot x} \cdot \ln \alpha \cdot 1
      =
      \ln \alpha \cdot \alpha^x.
    \end{equation*}

    \item Преди да пресметнем производните на \( \sin(x) \) и \( \cos(x) \), нека се убедим в два факта:
    \begin{enumerate}
      \item \( \sin(x) \) и \( \cos(x) \) са непрекъснати функции в \( \R \). Наистина, нека фиксираме \( \varepsilon > 0 \). С цел да определим какво \( \delta \) ни е необходимо, нека фиксираме произволно \( \delta > 0 \). Тогава за произволно \( x_0 \in \R \) имаме
      \begin{align*}
        \Abs{\sin(x_0 + \delta) - \sin(x_0)}
        &=
        \Abs{\sin(x_0 + \delta) + \sin(-x_0)}
        = \\ &=
        2 \Abs{\sin\left(\frac \delta 2 \right) \cos \left(x_0 + \frac \delta 2 \right)}
        \leq \\ &\leq
        2 \Abs{\sin\left(\frac \delta 2 \right)}
        \leq \\ &=
        2 \Abs{\frac \delta 2}
        = \\ &=
        \delta.
      \end{align*}

      Следователно за всяко \( \varepsilon > 0 \) е достатъчно да изберем \( \delta < \varepsilon \), за да бъде изпълнено
      \begin{equation*}
        \Abs{\sin(y) - \sin(x_0)} < \varepsilon \text{ при } \Abs{y - x_0} < \delta.
      \end{equation*}

      Показахме, че \( \sin(x) \) е непрекъсната функция в точката \( x_0 \), а понеже \( x_0 \) беше произволна, то \( \sin(x) \) е непрекъсната навсякъде. Като следствие, \( \cos(x) = \sin(\pi / 2 - x) \) също е непрекъсната навсякъде.

      \item \( \sin'(0) \) съществува и е равна на единица. Наистина, за \( h \in (0, \pi / 2] \) имаме
      \begin{align*}
        \tan(h) &\geq h \geq \sin(h),
        \\
        \frac {\cos(h)} {\sin(h)} &\leq \frac 1 h \leq \frac 1 {\sin(h)}, \quad\mid \cdot \sin(h)
        \\
        \cos(h) &\leq \frac {\sin(h)} h \leq 1,
      \end{align*}
      откъдето следва
      \begin{equation*}
        1
        =
        \lim_{h \to 0} \cos(h)
        \leq
        \lim_{h \to 0} \frac {\sin(h)} h
        \leq
        \sin'(0)
        \leq
        1.
      \end{equation*}
    \end{enumerate}

    За произволно \( \sin(x) \) пресмятаме
    \begin{align*}
      \sin'(x)
      &=
      \lim_{h \to 0} \frac {\sin(x+h) - \sin(x)} h
      = \\ &=
      \lim_{h \to 0} \frac {\sin(x+h) + \sin(-x)} h
      = \\ &=
      \lim_{h \to 0} \frac {2 \sin(h / 2) \cos(x+h/2)} h
      = \\ &=
      \lim_{h \to 0} \cos \left(x + \frac h 2 \right) \cdot \lim_{h \to 0} \frac {\sin(h / 2)} {h/2}
      = \\ &=
      \cos(x) \cdot 1.
    \end{align*}

    Тогава за \( \cos(x) \) получаваме
    \begin{equation*}
      \cos'(x) = \sin'(\pi / 2 - x) = \cos(\pi / 2 - x) \cdot (-1) = -\sin(x).
    \end{equation*}
  \end{enumerate}
\end{proof}

За константите важи и по-слаб вариант на обратното твърдение:
\begin{proposition}\label{thm:zero_derivative}
  Нека \( a < b \in \R \), функцията \( f: [a, b] \to \R \) е диференцируема в \( (a, b) \) и непрекъсната в \( [a, b] \) и производната ѝ е тъждествено нула в \( (a, b) \). Тогава \( f(x) \) е константа.
\end{proposition}
\begin{remark}
  Доказателството на този факт използва теоремата за крайните нараствания, която е извън рамките на тази тема.
\end{remark}

\begin{theorem}[Теорема за обратната функция]
  Нека \( D \subseteq \R \) е произволно множество и функцията \( f: D \to \R \) е непрекъснато диференцируема в точка \( a \in D \), при това \( f'(a) \neq 0 \). Тогава \( f(x) \) е обратима в околност на \( a \) и обратната функция \( f^{-1} (x) \) е непрекъснато диференцируема в точката \( f(a) \) с производна \( \frac 1 {f'(a)} \).
\end{theorem}
\begin{proof}
  Доказателството не е тривиално и няма да го даваме.
\end{proof}

\begin{remark}\label{remark:derivatives_of_invertible_functions}
  Да забележим, че в околността, в която функцията е обратима, имаме
  \begin{align*}
    f^{-1}(f(x)) &= x \mid \frac d {dx}
    \\
    f^{-1'}(f(x)) \cdot f'(x) &= 1
    \\
    f^{-1'}(f(x)) &= \frac 1 {f'(x)}
  \end{align*}

  На практика е удобно да използваме означението на Лайбниц:
  \begin{equation*}
    \frac {dx} {df} = {\left( \frac {df} {dx} \right)}^{-1}.
  \end{equation*}
  Естествено, тази формула важи само в околността, в която функцията е обратима.
\end{remark}

\begin{theorem}
  \mbox{}
  \begin{enumerate}
    \item Производната на \( \ln(x) \) при \( x > 0 \) е \( \frac 1 x \).
    \item Производната на \( \arcsin(x) \) при \( x \in [-1, 1] \) е \( \frac 1 {\cos(x)} \).
  \end{enumerate}
\end{theorem}
\begin{proof}
  Ще използваме забележка~\ref{remark:derivatives_of_invertible_functions}.

  \begin{enumerate}
    \item Функцията \( \ln(x) \) е обратна на \( e^x \) за всички стойности на \( e^x \), следователно
    \begin{equation*}
      \ln'(e^x) = \frac 1 {e^x}.
    \end{equation*}

    Тогава за \( x > 0 \) имаме
    \begin{equation*}
      \ln'(x) = \frac 1 {x}.
    \end{equation*}

    \item Функцията \( \arcsin(x) \) е обратна на \( \sin(x) \), когато \( x \in [0, 2\pi] \), следователно
    \begin{equation*}
      \arcsin'(\sin(x)) = \frac 1 {\cos(x)} = \frac 1 {\sqrt{1 - {\sin(x)}^2}}.
    \end{equation*}

    Тогава за \( x \in \sin([0, 2\pi]) = [-1, 1] \) имаме
    \begin{equation*}
      \arcsin'(x) = \frac 1 {\sqrt{1 - x^2}}.
    \end{equation*}
  \end{enumerate}
\end{proof}

\subsection{Примитивни функции}

\begin{definition}
  Нека \( D \subseteq \R \) е отворено и \( f: D \to \R \) е някаква функция. Казваме, че \textbf{функцията \( F: D \to \R \) е примитивна за \( f(x) \)}, ако \( F(x) \) е диференцируема и производната ѝ съвпада с \( f(x) \).
\end{definition}

\begin{theorem}
Нека \( a < b \in \R \), функцията \( f: [a, b] \to \R \) е диференцируема в \( (a, b) \) и непрекъсната в \( [a, b] \) и функциите \( F: [a, b] \to \R \) и \( G: [a, b] \to \R \) са примитивни функции на \( f(x) \) в \( (a, b) \). Тогава съществува константа \( c \in \R \), такава че
  \begin{equation*}
    F(x) = c + G(x).
  \end{equation*}
\end{theorem}
\begin{proof}
  Ако \( F(x) \) и \( G(x) \) са едновременно диференцируеми в точката \( a \in D \), за тяхната разлика имаме
  \begin{equation*}
    (F - G)'(x)
    =
    F'(x) - G'(x)
    =
    f(x) - f(x)
    =
    0.
  \end{equation*}

  Според твърдение~\ref{thm:zero_derivative}, функцията \( F(x) - G(x) \) е константа. Полагаме \( c \coloneqq F(x) - G(x) \), с което доказваме теоремата.
\end{proof}

\printbibliography

\end{document}
