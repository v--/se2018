\documentclass[numbers=endperiod, bibliography=totocnumbered]{scrartcl}

\usepackage{../../common/base_math_packages}
\usepackage{../../common/fonts}
\usepackage{../../common/base_packages}
\usepackage{../../common/macros}
\usepackage{../../common/theorem_styles}

% Custom packages
\usepackage{../../common/macros}
\usepackage{../../common/theorem_styles}

% Bibliography
\addbibresource{./references.bib}

% Document
\title{Тема 5}
\subtitle{Теореми за средните стойности (Рол, Лагранж и Коши). Формула на Тейлър.}
\author{Янис Василев, \Email{ianis@ivasilev.net}}
\date{6 юли 2019}

\begin{document}

\maketitle

\section{Теория}

Доказателството на теоремата на Тейлър е взаимствано от~\cite{Fichtenholz}.

\subsection{Анотация}

Изложената анотацията е взета от конспекта~\cite{Syllabus} за 2018г.

\begin{enumerate}
  \item Теоремата на Рол с доказателство, базирано на теоремата на Вайерщрас
  \item Теоремите за средните стойности на Лагранж и Коши
  \item Формула на Тейлър с остатъчен член във формата на Лагранж и Коши
\end{enumerate}

\subsection{Помощни теореми}

\begin{definition}
  Нека \( D \subseteq \R \) и \( f: D \to \R \) е произволна функция.

  \begin{enumerate}
    \item Казваме, че \underLine{функцията \( f(x) \) има локален максимум в точка \( a \in D \)}, ако за някаква околност \( U_a \) на \( a \) е изпълнено \( f(a) \geq f(u)~\forall u \in U_a \).

    \item Казваме, че \underLine{функцията \( f(x) \) има локален минимум в точка \( a \in D \)}, ако за някаква околност \( U_a \) на \( a \) е изпълнено \( f(a) \leq f(u)~\forall u \in U_a \).

    \item Ако \( f(x) \) има или локален максимум, или локален минимум в точка \( a \), казваме, че \underLine{\( f(x) \) има локален екстремум в тока \( a \)}.
  \end{enumerate}
\end{definition}

\begin{theorem}[Вайерщрас]
  Нека \( a < b \) и функцията \( f: [a, b] \to \R \) е непрекъсната. Тогава \( f(x) \) достига в \( [a, b] \) своите минимум и максимум.
\end{theorem}
\begin{proof}
  Нека \( M \coloneqq \sup_{x \in [a, b]} f(x) \). Тогава съществува редица \( \{ a_k \} \subseteq [a, b] \), за която съответната редица от функционални стойности \( \{ f(a_k) \} \) клони към \( M \).

  Тъй като интервалът \( [a, b] \) е ограничен, редицата също \( \{ a_k \} \) е ограничена и според теоремата на Болцано-Вайерщрас, тя има сходяща подредица.

  Нека \( \{ a_{k_i} \} \) е една сходяща подредица на \( \{ a_k \} \). Тъй като интервалът \( [a, b] \) е затворен, границата \( \alpha \) на редицата \( \{ a_{k_i} \} \) лежи в този интервал.

  Понеже \( f(x) \) е непрекъсната, имаме
  \begin{align*}
    \lim_{i \to \infty} f(a_{k_i}) = f(\alpha) = M,
  \end{align*}
  където последното равенство получихме от еднозначността на сходимостта на редици.
\end{proof}

\begin{theorem}[Ферма]
  Нека \( D \subseteq \R \) и функцията \( f: D \to \R \) е диференцируема в точката \( a \in D \). Необходимо условия за това \( f(x) \) да има локален екстремум в \( a \) е производната \( f'(a) \) да се анулира.
\end{theorem}
\begin{proof}
  Нека без ограничение на общността \( f(x) \) да има локален минимум в \( a \). Тогава
  \begin{align*}
    f'(a) = \lim_{h \downarrow 0} \frac {f(a+h) - f(a)} h \geq 0,
  \end{align*}
  тъй като \( f(a+h) \geq f(a) \) за достатъчно малко \( h > 0 \). Обратно,
  \begin{align*}
    f'(a) = \lim_{h \uparrow 0} \frac {f(a+h) - f(a)} h \leq 0,
  \end{align*}
  тъй като \( f(a+h) \geq f(a) \) за достатъчно малко по абсолютна стойност \( h < 0 \).

  Заключаваме, че \( f'(a) = 0 \).
\end{proof}

\subsection{Теореми за средните стойности}

\begin{theorem}[Рол]
  Нека \( a < b \), а функцията \( f: [a, b] \to \R \) е непрекъсната в \( [a, b] \) и диференцируема в \( (a, b) \). Ако \( f(a) = f(b) \), съществува точка \( c \in (a, b) \), такава че \( f'(c) = 0 \).
\end{theorem}
\begin{proof}
  Разглеждаме три случая:
  \begin{enumerate}
    \item Нека \( f(x) \equiv f(a) \) е тъждествено константа. Тогава избираме \( c \) да бъде произволна точка от \( (a, b) \), тъй като \( f'(x) = 0 \) за всяко \( x \in [a, b] \).
    \item Нека \( f(x) > f(a) \) за някое \( x \). Според теоремата на Вайерщрас, функцията \( f(x) \) достига своя максимум \( M_f \) в интервала \( [a, b] \) и според допускането ни имаме \( M_f > f(a) \). При това този максимум се достига непременно във вътрешността на интервала. Нека \( c \in (a, b) \) е точка, за която \( f(c) = M_f \). Тъй като \( M_f \) е локален максимум, по теоремата на Ферма имаме \( f'(c) = 0 \).
    \item Нека \( f(x) \) не е тъждествено константа и \( f(x) \leq f(a)~\forall x \in [a, b] \). Тогава прилагаме вече доказания случай към функцията \( -f(x) \) и получаваме константа \( c \in (a, b) \), за която \( f'(c) = -f'(c) = 0 \).
  \end{enumerate}
\end{proof}

\begin{theorem}[Теорема на Лагранж за крайните нараствания]
  Нека \( a < b \), а функцията \( f: [a, b] \to \R \) е непрекъсната в \( [a, b] \) и диференцируема в \( (a, b) \). Тогава съществува точка \( c \in (a, b) \), такава че
  \begin{align*}
    f'(c) = \frac {f(b) - f(a)} {b-a}.
  \end{align*}
\end{theorem}
\begin{proof}
  Разглеждаме спомагателната функция
  \begin{align*}
    g(x) \coloneqq f(x) - \frac {f(b) - f(a)} {b-a} x,
  \end{align*}
  за която имаме
  \begin{align*}
    g(a)
    =
    f(a) - \frac {f(b) - f(a)} {b-a} a
    =
    \frac {b \cdot f(a) - a \cdot f(b)} {b-a}
    =
    f(b) - \frac {f(b) - f(a)} {b-a} b
    =
    g(b).
  \end{align*}

  Освен това \( g(x) \) е непрекъсната в \( [a, b] \) като сума на непрекъснати в \( [a, b] \) функции и диференцируема в \( (a, b) \) като сума на диференцируеми в \( (a, b) \) функции. Това ни позволява да приложим теоремата на Рол към \( g(x) \), за да получим константа \( c \), за която

  \begin{align*}
    0 = g'(c) = f'(c) - \frac {f(b) - f(a)} {b-a}.
  \end{align*}

  Но тогава
  \begin{align*}
    f'(c) = \frac {f(b) - f(a)} {b-a}.
  \end{align*}
\end{proof}

\begin{theorem}[Теорема на Коши]
  Нека \( a < b \), а функцията \( f: [a, b] \to \R \) и \( g: [a, b] \to \R \) са непрекъснати в \( [a, b] \) и диференцируеми в \( (a, b) \) и нека \( g'(x) \neq 0 \) за \( x \in (a, b) \). Тогава съществува точка \( c \in (a, b) \), такава че
  \begin{align*}
    \frac {f'(c)} {g'(c)} = \frac {f(b) - f(a)} {g(b) - g(a)}.
  \end{align*}
\end{theorem}
\begin{proof}
  Да отбележим първо, че \( g'(x) \neq 0 \) в \( (a, b) \) влече, че условията на теоремата на Рол не са изпълнена за \( g(x) \) и следователно \( g(a) \neq g(b) \).

  Разглеждаме спомагателната функция
  \begin{align*}
    h(x) \coloneqq f(x) - \frac {f(b) - f(a)} {g(b) - g(a)} g(x),
  \end{align*}
  за която имаме
  \begin{align*}
    h(a)
    &=
    f(a) - \frac {f(b) - f(a)} {g(b) - g(a)} g(a)
    = \\ &=
    \frac {f(a) \cdot g(b) - f(b) \cdot g(a)} {g(b)-g(a)}
    = \\ &=
    f(b) - \frac {f(b) - f(a)} {g(b) - g(a)} g(b)
    =
    h(b).
  \end{align*}

  Функцията \( h(x) \) е непрекъсната в \( [a, b] \) като линейна комбинация на непрекъснати в \( [a, b] \) функции и диференцируема в \( (a, b) \) като линейна комбинация на диференцируеми в \( (a, b) \) функции. Това ни позволява да приложим теоремата на Рол към \( h(x) \), за да получим константа \( c \), за която

  \begin{align*}
    0 = h'(c) = f'(c) - \frac {f(b) - f(a)} {g(b) - g(a)} g'(c).
  \end{align*}

  Но тогава
  \begin{align*}
    \frac {f'(c)} {g'(c)} = \frac {f(b) - f(a)} {g(b) - g(a)}.
  \end{align*}
\end{proof}

\subsection{Теорема на Тейлър}

\begin{theorem}[Тейлър]
  Нека \( a < b \), а функцията \( f: [a, b] \to \R \) е непрекъсната в \( [a, b] \) и \( n+1 \)-кратно диференцируема в \( (a, b) \). Тогава за произволна точка \( \xi \in (a, b) \) в достатъчно малка околност на \( \xi \) е изпълнено
  \begin{align*}
    f(x) = \sum_{k=0}^n \frac {f^{(k)}(\xi)} {k!} {(x-\xi)}^k + R(x),
  \end{align*}
  където \( R(x) \Conv[x \to \xi]{} 0 \).
\end{theorem}
\begin{proof}
  Фиксираме \( \xi, x \in (a, b) \) и полагаме \( U \coloneqq [\min(\xi, x), \max(\xi, x)] \). Дефинираме спомагателната функция
  \begin{align*}
    \varphi(t) \coloneqq f(x) - \sum_{k=0}^n \frac {f^{(k)}(t)} {k!} {(x-t)}^k.
  \end{align*}

  Тази функция обобщава остатъчния член, тъй като \( \varphi(\xi) = R(x) \). За производната ѝ имаме
  \begin{align*}
    \varphi'(t)
    =
    f'(t) -\sum_{k=1}^n \left( \frac {f^{(k+1)}(t)} {k!} {(x-t)}^k - \frac {f^{(k)}(t)} {(k-1)!} {(x-t)}^{k-1} \right)
    =
    - \frac {f^{(n+1)}(t)} {n!} {(x-t)}^n.
  \end{align*}

  За да изразим остатъчният член в различни форми, използваме още една спомагателна функция. Нека \( \psi: U \to \R \) е непрекъсната в \( U \) и диференцируема във вътрешността \( \Int U \). Нека освен това производната \( \psi'(t) \) да бъде различна от \( 0 \) в интервала \( \Int U \).

  От теоремата на Коши намираме константа \( c \in \Int U \), така че
  \begin{align*}
    \frac {\varphi'(c)} {\psi'(c)}
    =
    \frac {\varphi(x) - \varphi(\xi)} {\psi(x) - \psi(\xi)}.
  \end{align*}

  Понеже \( \varphi(x) = 0 \) и \( \varphi(\xi) = R(x) \), за остатъчния член имаме
  \begin{align*}
    R(x)
    =
    -\frac {\psi(x) - \psi(\xi)} {\psi'(c)} \varphi'(c)
    =
    \frac {\psi(x) - \psi(\xi)} {\psi'(c)} \frac {f^{(n+1)}(c)} {n!} {(x-c)}^n.
  \end{align*}

  От непрекъснатостта на \( \psi(t) \) следва, че \( R(x) \Conv[x \to \xi]{} 0 \).
\end{proof}

В зависимост от конкретния вид на функцията \( \psi(t) \), можем да получим различни форми за остатъчните членове:
\begin{enumerate}
  \item Казваме, че \underLine{остатъчният член е във форма на Лагранж}, ако \( \psi(t) = {(x-t)}^{n+1} \).

  В такъв случай имаме \( \psi(x) = 0 \), \( \psi'(t) = -(n+1) {(x-t)}^n \) и
  \begin{align*}
    R(x)
    &=
    \frac {\psi(x) - \psi(\xi)} {\psi'(c)} \frac {f^{(n+1)}(c)} {n!} {(x-c)}^n
    = \\ &=
    \frac {-{(x-\xi)}^{n+1}} {-(n+1) {(x-c)}^n} \frac {f^{(n+1)}(c)} {n!} {(x-c)}^n
    = \\ &=
    \boxed{\frac {f^{(n+1)}(c)} {(n+1)!} {(x-\xi)}^{n+1}}.
  \end{align*}

  \item Казваме, че \underLine{остатъчният член е във форма на Коши}, ако \( \psi(t) = x-t \).

  В такъв случай имаме \( \psi(x) = 0 \), \( \psi'(t) = -1 \) и
  \begin{align*}
    R(x)
    &=
    \frac {\psi(x) - \psi(\xi)} {\psi'(c)} \frac {f^{(n+1)}(c)} {n!} {(x-c)}^n
    = \\ &=
    \frac {-(x-\xi)} {-1} \frac {f^{(n+1)}(c)} {n!} {(x-c)}^n
    = \\ &=
    \boxed{\frac {f^{(n+1)}(c)} {n!} {(x-c)}^n {(x-\xi)}}.
  \end{align*}
\end{enumerate}

\section{Задачи}

Условията на представените задачи са взети от~\cite{Syllabus}.

\begin{exercise}
  Нека \( f(t) = a (1-t) \cos(at) - \sin(at) \), където \( a \) е произволно фиксирано реално число. Като се използва теоремата на Рол, да се докаже, че уравнението \( f(t) = 0 \) има поне един реален корен в интервала \( (0, 1) \).
\end{exercise}
\begin{solution}
  Намираме примитивна на \( f(t) \) функция
  \begingroup
  \allowdisplaybreaks
  \begin{align*}
    F(t)
    &=
    \int_0^t f(x) dx
    = \\ &=
    a \int_0^t (1-x) \cos(ax) dx - \int_0^t \sin(ax) dx
    = \\ &=
    \int_0^t (1-x) d(\sin(ax)) - \int_0^t \sin(ax) dx
    = \\ &=
    (1-t) \sin(at) - \int_0^t \sin(ax) d(1-x) - \int_0^t \sin(ax) dx
    = \\ &=
    (1-t) \sin(at) + \int_0^t \sin(ax) dx - \int_0^t \sin(ax) dx
    = \\ &=
    (1-t) \sin(at).
  \end{align*}
  \endgroup

  Стойностите на функцията \( F(t) \) в краищата на интервала \( [0, 1] \) се анулират. Тогава теоремата на Рол ни дава константа \( c \in (0, 1) \), за която
  \begin{align*}
    F'(c) = f(c) = 0.
  \end{align*}

  Следователно \( c \in (0, 1) \) е корен на уравнението \( f(t) = 0 \).
\end{solution}

\printbibliography

\end{document}
